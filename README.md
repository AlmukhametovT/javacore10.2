[скриншоты к решению в папке solution](https://github.com/AlmukhametovT/javacore10.2/solution)

# Вывод консоли

Please open 'ru.netology.JvmExperience' in VisualVm  
21:56:42.681720600: loading io.vertx  
21:56:43.293722700: loaded 529 classes  
21:56:46.296746: loading io.netty  
21:56:48.152819800: loaded 2117 classes  
21:56:51.155868800: loading org.springframework  
21:56:51.535869400: loaded 869 classes  
21:56:54.544877400: now see heap  
21:56:54.544877400: creating 5000000 objects  
21:56:55.228888600: created  
21:56:58.228892800: creating 5000000 objects  
21:56:58.674897700: created  
21:57:01.796904400: creating 5000000 objects  
21:57:02.332913900: created  

Process finished with exit code 0  


# Classes & CPU  
[как истинный "хакер" отметил выполняемые строки кода в paint](https://github.com/AlmukhametovT/javacore10.2/solution/2 loadToMetaspaceAllFrom.jpeg)  
**работаем с графиками CPU и Classes**  
до 21.56.42 код ведет себя спокойной, 
подгрузились примерно 2102 класса, загрузка CPU 0-2,7%  

*21:56:42.681720600: loading io.vertx*  
*21:56:43.293722700: loaded 529 classes*  
21.56.42 начинаются подгружаться классы "io.vertx", пиковая загрузка CPU 48,2%  
подгрузилось 529 классов, согласно консоли, согласно графику Classes стало 2932 класса (т.е. выросло на 830 классов)...  
в коде работали строки 16-17  

*21:56:46.296746: loading io.netty*  
*21:56:48.152819800: loaded 2117 classes*  
21.56.46 начинаются подгружаться классы "io.netty", пиковая загрузка CPU 58,9%  
подгрузилось 2117 классов, согласно консоли, согласно графику Classes стало 5013 классов (т.е. выросло на 2081 классов)...  
в коде работали строки 18-19  

*21:56:51.155868800: loading org.springframework*  
*21:56:51.535869400: loaded 869 classes*  
21.56.51 начинаются подгружаться классы "org.springframework", пиковая загрузка CPU 30,7%  
подгрузилось 869 классов, согласно консоли, согласно графику Classes стало 5905 классов (т.е. выросло на 892 класса)...  
в коде работали строки 20-21  

*прочие пики в графике CPU связаны с добавлением объектов в лист List<SimpleObject> simpleObjects (рост) и результатом работы сборщика мусора (падение)*  

*могу предположить почему разница классов больше, чем в сообщении с консоли,*  
*возможно подгружаются сторонние классы, не связанные именно с выполнением данного метода.*  
*но почему при загрузке классов io.netty разника наоборот меньше?... врет вывод консоли или врет VisualVM?*  
*в целом цифры очен близки, будем считать погрешностью*  

# Heap & Metaspace  
[анализ графиков Heap & Metaspace](https://github.com/AlmukhametovT/javacore10.2/solution/3 Heap Metaspace.jpeg)  
*21:56:54.544877400: now see heap*  
бежим внимательно смотреть графики хипа, до этой секунды ничего интересного,  
скучная прямая, на хип выделено 100Мб, из которых на пике задействовано 61Мб  
переключаемся на метаспейс... а тут-то надо было следить при создании классов:)  
т.к. классы загружаются в метаспейс, то строки кода 16-21 при загрузке классов изменяли  график Metaspace  
аналогично указанным промежуткам времени выше, ступенькой как и график Classes изменяется используемая память Metaspace,  
т.к. используемая память метаспейс становится больше размера Metaspace size, то изменяется и выделяемая память максимальная на метаспейс.  
*очень интересно, почему объем используемого метаспейс равнялся 0 до 21.56.39, хотя уже было загружено более 2000 классов?*  
*так же интересно, почему рост объема метаспейс проходил в 5 этапов, хотя загрузка классов шла в 4 этапа?*  
*(1. системные классы, 2. io.vertx, 3.io.netty, 4. org.springframework)*  

*21:56:54.544877400: creating 5000000 objects*  
*21:56:55.228888600: created*  
до 21.56.54 размер хипа 100Мб, задейсвовано на пике 61Мб,  
после добавления 5000000 objects в List<SimpleObject> simpleObjects размер хипа растет до 452Мб, при этом задействовано - 193Мб  
в коде работали строки 24-25  

*21:56:58.228892800: creating 5000000 objects*  
*21:56:58.674897700: created*  
после добавления 5000000 objects в List<SimpleObject> simpleObjects размер хипа растет до 905Мб, при этом задействовано - 355Мб  
в коде работали строки 26-27  

*21:57:01.796904400: creating 5000000 objects*  
*21:57:02.332913900: created*  
после добавления 5000000 objects в List<SimpleObject> simpleObjects размер хипа растет до 1Гб, при этом задействовано - 707Мб  
в коде работали строки 28-29  

далее по графику хипа видимо что сборщик мусора тоже не сидел без дела, размер задействованного хипа уменьшился до 646Мб, выделенный размер не изменялся  